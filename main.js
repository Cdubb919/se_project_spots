!function(){var e={31:function(e,t,r){"use strict";e.exports=r.p+"c5b17daa11333c2f0346.svg"},36:function(e,t,r){"use strict";e.exports=r.p+"d19faa0112f44e2b6e01.svg"},58:function(e,t,r){"use strict";e.exports=r.p+"ac218ab8ae2c025add31.jpg"},66:function(e,t,r){"use strict";e.exports=r.p+"44b92084d1c40cb0a70b.jpg"},117:function(e,t,r){"use strict";e.exports=r.p+"2fc47fd8e9a9bcd9612f.jpg"},238:function(e,t,r){"use strict";e.exports=r.p+"53f0bab7ec2e970778f9.svg"},303:function(e,t,r){"use strict";e.exports=r.p+"40608da7369d39bc1077.svg"},338:function(e,t,r){"use strict";e.exports=r.p+"f37cd48ce187723b17f6.jpg"},353:function(e,t,r){"use strict";e.exports=r.p+"6cc9a0b44bfd83f0954f.svg"},418:function(e,t,r){"use strict";e.exports=r.p+"29a25a3c4fb6b6e4a7d6.svg"},511:function(e,t,r){"use strict";e.exports=r.p+"a326e1ad56a2cd944a28.svg"},528:function(e,t,r){"use strict";e.exports=r.p+"a326e1ad56a2cd944a28.svg"},563:function(e,t,r){"use strict";e.exports=r.p+"b431bbb397d7a39486fd.jpg"},588:function(e,t,r){var o={"./1-photo-by-moritz-feldmann-from-pexels.jpg":751,"./2-photo-by-ceiline-from-pexels.jpg":926,"./3-photo-by-tubanur-dogan-from-pexels.jpg":563,"./4-photo-by-maurice-laschet-from-pexels.jpg":66,"./5-photo-by-van-anh-nguyen-from-pexels.jpg":58,"./6-photo-by-moritz-feldmann-from-pexels.jpg":338,"./Group2.svg":988,"./Logo.svg":848,"./Union.svg":418,"./avatar.jpg":117,"./closeicon.svg":528,"./closeicondefault.svg":511,"./closeiconhover.svg":878,"./closemodalbtn.svg":238,"./closemodalhoverstate.svg":31,"./deletebtn.svg":36,"./deletebtnHover.svg":842,"./editAvatarimg.svg":683,"./likebtncolorchg.svg":783,"./likebtnhoverstate.svg":353,"./plusiconuse.svg":303};function n(e){var t=a(e);return r(t)}function a(e){if(!r.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=a,e.exports=n,n.id=588},683:function(e,t,r){"use strict";e.exports=r.p+"1e97cb162582fe640c54.svg"},751:function(e,t,r){"use strict";e.exports=r.p+"418980fdb81d7ceb84cc.jpg"},783:function(e,t,r){"use strict";e.exports=r.p+"0f0dda9918e145f68d20.svg"},842:function(e,t,r){"use strict";e.exports=r.p+"86ae92bd1a937388d496.svg"},848:function(e,t,r){"use strict";e.exports=r.p+"8650253b58b46f0f1c06.svg"},878:function(e,t,r){"use strict";e.exports=r.p+"a8e301eb86866b1df117.svg"},926:function(e,t,r){"use strict";e.exports=r.p+"da7ae2ac910426f62176.jpg"},988:function(e,t,r){"use strict";e.exports=r.p+"1ecf96fab54a91c898b4.svg"}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=e=>{document.querySelectorAll(e.formSelector).forEach(r=>{((e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),a=e.querySelector(r.submitButtonSelector);n.forEach(s=>{s.addEventListener("input",function(){((e,r,o)=>{r.validity.valid?t(e,r,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,r,r.validationMessage,o)})(e,s,r),o(n,a,r)})})})(r,e)})};function a(e,t,r="Save",o="Saving..."){e&&(e.textContent=t?o:r)}n(e);r(588);const s=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitialCards,this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}addCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}addLike(e,t){const r=t?"DELETE":"PUT";return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:r,headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"1e20e2ef-1387-4112-bcbf-1a5b3929946c","Content-Type":"application/json"}}),c=document.querySelector(".profile__edit-btn"),i=document.querySelector("#edit-profile-modal"),d=document.querySelector("#profile-avatar-input"),l=i.querySelector(".modal__close-btn"),u=i.querySelector(".modal__form"),m=i.querySelector("#profile-name-input"),f=i.querySelector("#profile-description-input"),p=document.querySelector(".profile__add-btn"),v=document.querySelector("#new-post-modal"),_=v.querySelector(".modal__close-btn"),b=v.querySelector(".modal__form"),h=v.querySelector("#card-image-input"),y=v.querySelector("#caption-description-input"),g=document.querySelector("#edit-avatar-form"),S=document.querySelector(".profile__avatar-btn"),E=g.elements.avatar,q=(g.querySelector(".modal__submit-btn"),document.querySelector(".profile__name")),k=document.querySelector(".profile__description"),L=(document.getElementById("nameInput"),document.querySelector(".card__image"),document.querySelector(".card__title"),document.querySelector("#avatar-modal")),x=document.querySelector("#avatar-modal .modal__caption"),j=document.querySelector("#avatar-modal .modal__image"),C=document.querySelector(".modal__close-btn"),$=document.querySelector("#delete-modal"),U=$.querySelector(".modal__form"),I=(document.querySelector("#card_template").content.querySelector(".card"),document.querySelector(".cards__list"));document.querySelector(".like-button");let P=null,A=null,B=null,D=null;function O(e){"Escape"===e.key&&F(document.querySelector(".modal_is-opened"))}document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("click",t=>{t.target.classList.contains("modal")&&F(e)})}),g.addEventListener("submit",function(e){e.preventDefault(),s.editAvatarInfo(E.value).then(e=>{console.log(e.avatar);const t=document.querySelector(".profile__avatar");t&&(t.src=e.avatar),F(d),E.value=""}).catch(e=>{console.error("Failed to update avatar:",e),alert("Could not update avatar. Please try again.")})}),S.addEventListener("click",()=>{w(d),d.querySelector(".modal__close-btn").addEventListener("click",()=>{F(d)})}),document.getElementById("saveBtn");const T=document.getElementById("deleteBtn");function N(e){const t=document.querySelector("#card_template").content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&n.classList.add("card__like-btn_active"),n.addEventListener("click",()=>{const t=n.classList.contains("card__like-btn_active");s.addLike(e._id,t).then(e=>{console.log("Updated card response:",e),n.classList.toggle("card__like-btn_active",e.isLiked)}).catch(e=>console.error("Like toggle failed:",e))}),o.addEventListener("click",()=>function(e){j.src=e.link,j.alt=e.name,x.textContent=e.name,w(L)}(e)),a.addEventListener("click",()=>{!function(e,t){B=e,D=t._id,w($)}(t,e),w($)}),t}function w(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",O)}function F(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",O)}function H(){document.getElementById("delete-modal").classList.add("modal_is-opened")}document.getElementById("profile-form"),U.addEventListener("submit",e=>{e.preventDefault(),T.textContent="Deleting...",T.disabled=!0,s.deleteCard(D).then(()=>{B&&B.remove(),F($)}).catch(e=>{console.error("Error deleting card:",e),alert("Failed to delete card. Please try again.")}).finally(()=>{T.textContent="Delete",T.disabled=!1})}),document.addEventListener("click",function(e){e.target.classList.contains("card__delete-btn")&&H()}),c.addEventListener("click",()=>{m.value=q.textContent,f.value=k.textContent;const r=Array.from(u.querySelectorAll(e.inputSelector));((e,r,o)=>{r.forEach(r=>{t(e,r,o)})})(u,r,e),w(i)}),l.addEventListener("click",()=>{F(i)}),p.addEventListener("click",function(){w(v)}),_.addEventListener("click",()=>{F(v)}),document.querySelector(".cards__list"),u.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;a(t,!0);const r=m.value.trim(),o=f.value.trim();if(!r||!o)return console.error("Name and About fields must not be empty."),void a(t,!1);s.editUserInfo({name:r,about:o}).then(e=>{q.textContent=e.name,k.textContent=e.about,F(i)}).catch(e=>{console.error("Failed to update profile:",e)}).finally(()=>{a(t,!1)})}),C.addEventListener("click",function(){F(L)}),b.addEventListener("submit",function(t){t.preventDefault();const r=b.querySelector(".modal__submit-btn"),n={name:y.value.trim(),link:h.value.trim()};n.name&&n.link?(a(r,!0),s.addCard(n).then(t=>{const n=N(t);I.prepend(n),F(v),b.reset();const a=Array.from(b.querySelectorAll(e.inputSelector));o(a,r,e)}).catch(e=>{console.error("Failed to add card:",e)}).finally(()=>{a(r,!1)})):console.error("Both name and image link are required.")}),s.getInitialCards().then(e=>{e.forEach(e=>{console.log("Card item:",e);const t=N(e);I.append(t)})}).catch(console.error),document.addEventListener("click",e=>{if(e.target.classList.contains("card__delete-btn")){const t=e.target.closest(".card"),r=t?.dataset.id;if(!r)return void console.error("Card ID not found");P=t,A=r,H()}}),s.getUserInfo().then(e=>{const t=document.querySelector(".profile__avatar");t&&(t.src=e.avatar)}),U.addEventListener("submit",function(e){e.preventDefault(),s.deleteCard(D).then(()=>{B.remove(),F($)}).catch(console.error)}),n(e)}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixFQUFJVSxrQkFDQ0csS0FBTWtHLElBQ0hBLEVBQU1oSSxRQUFTaUksSUFDWGxDLFFBQVFDLElBQUksYUFBY2lDLEdBQzFCLE1BQU12QixFQUFjRCxFQUFld0IsR0FDbkNsRCxFQUFVbUQsT0FBT3hCLE9BR3hCUCxNQUFNSixRQUFRTSxPQUVuQnZHLFNBQVNRLGlCQUFpQixRQUFVZ0YsSUFDaEMsR0FBSUEsRUFBSUksT0FBT3pHLFVBQVUwRyxTQUFTLG9CQUFxQixDQUNuRCxNQUFNZSxFQUFjcEIsRUFBSUksT0FBT3lDLFFBQVEsU0FDakNDLEVBQVMxQixHQUFhMkIsUUFBUXhMLEdBRXBDLElBQUt1TCxFQUVELFlBREFyQyxRQUFRTSxNQUFNLHFCQUlsQnBCLEVBQWV5QixFQUNmeEIsRUFBaUJrRCxFQUVqQmIsR0FDSixJQUdKdEcsRUFBSVcsY0FBY0UsS0FBTXdHLElBQ3BCLE1BQU1yQyxFQUFjbkcsU0FBU2YsY0FBYyxvQkFDdkNrSCxJQUNBQSxFQUFZQyxJQUFNb0MsRUFBUzFGLFVBS25Da0MsRUFBV3hFLGlCQUFpQixTQW5QNUIsU0FBNEJnRixHQUN4QkEsRUFBSU0saUJBRUozRSxFQUNLK0IsV0FBV29DLEdBQ1h0RCxLQUFLLEtBQ0ZxRCxFQUFhakcsU0FDYnNHLEVBQVdYLEtBRWRzQixNQUFNSixRQUFRTSxNQUN2QixHQTJPQXhHLEVBQWlCekIsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvaW1hZ2VzLyBzeW5jIG5vbnJlY3Vyc2l2ZSBcXC4oc3ZnJTdDanBlIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIG1hcCA9IHtcblx0XCIuLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiOiA3NTEsXG5cdFwiLi8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCI6IDkyNixcblx0XCIuLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIjogNTYzLFxuXHRcIi4vNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCI6IDY2LFxuXHRcIi4vNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIjogNTgsXG5cdFwiLi82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIjogMzM4LFxuXHRcIi4vR3JvdXAyLnN2Z1wiOiA5ODgsXG5cdFwiLi9Mb2dvLnN2Z1wiOiA4NDgsXG5cdFwiLi9Vbmlvbi5zdmdcIjogNDE4LFxuXHRcIi4vYXZhdGFyLmpwZ1wiOiAxMTcsXG5cdFwiLi9jbG9zZWljb24uc3ZnXCI6IDUyOCxcblx0XCIuL2Nsb3NlaWNvbmRlZmF1bHQuc3ZnXCI6IDUxMSxcblx0XCIuL2Nsb3NlaWNvbmhvdmVyLnN2Z1wiOiA4NzgsXG5cdFwiLi9jbG9zZW1vZGFsYnRuLnN2Z1wiOiAyMzgsXG5cdFwiLi9jbG9zZW1vZGFsaG92ZXJzdGF0ZS5zdmdcIjogMzEsXG5cdFwiLi9kZWxldGVidG4uc3ZnXCI6IDM2LFxuXHRcIi4vZGVsZXRlYnRuSG92ZXIuc3ZnXCI6IDg0Mixcblx0XCIuL2VkaXRBdmF0YXJpbWcuc3ZnXCI6IDY4Myxcblx0XCIuL2xpa2VidG5jb2xvcmNoZy5zdmdcIjogNzgzLFxuXHRcIi4vbGlrZWJ0bmhvdmVyc3RhdGUuc3ZnXCI6IDM1Myxcblx0XCIuL3BsdXNpY29udXNlLnN2Z1wiOiAzMDNcbn07XG5cblxuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHZhciBpZCA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpO1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhpZCk7XG59XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8obWFwLCByZXEpKSB7XG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBtYXBbcmVxXTtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSA1ODg7IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuXHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICAgIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwpID0+IHtcclxuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpOyIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KGJ1dHRvbiwgaXNMb2FkaW5nLCBkZWZhdWx0VGV4dCA9IFwiU2F2ZVwiLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBpZiAoIWJ1dHRvbikgcmV0dXJuO1xyXG4gIGJ1dHRvbi50ZXh0Q29udGVudCA9IGlzTG9hZGluZyA/IGxvYWRpbmdUZXh0IDogZGVmYXVsdFRleHQ7XHJcbn1cclxuXHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzLCByZXNldFZhbGlkYXRpb24sIHRvZ2dsZUJ1dHRvblN0YXRlLCBlbmFibGVWYWxpZGF0aW9uIH0gZnJvbSAnLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzJztcclxuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gJy4uL3V0aWxzL2hlbHBlcnMuanMnO1xyXG5pbXBvcnQgQXBpIGZyb20gJy4uL3V0aWxzL0FwaS5qcyc7XHJcblxyXG5jb25zdCBpbWFnZXMgPSByZXF1aXJlLmNvbnRleHQoJy4uL2ltYWdlcycsIGZhbHNlLCAvXFwuKHN2Z3xqcGU/ZykkLyk7XHJcblxyXG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAgICB7XHJcbi8vICAgICAgICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyAgICAge1xyXG4vLyAgICAgICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyAgICAge1xyXG4vLyAgICAgICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXHJcbi8vICAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICAgIH0sXHJcbi8vICAgICB7XHJcbi8vICAgICAgICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgICAgfSxcclxuLy8gICAgIHtcclxuLy8gICAgICAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4vLyAgICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICAgIH0sXHJcbi8vICAgICB7XHJcbi8vICAgICAgICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbi8vICAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyAgICAge1xyXG4vLyAgICAgICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyBdO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCIxZTIwZTJlZi0xMzg3LTQxMTItYmNiZi0xYTViMzkyOTk0NmNcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0QXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnRuID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XHJcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RGb3JtID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IG5ld1Bvc3RDYXJkSW1hZ2VJbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2UtaW5wdXRcIik7XHJcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uRGVzY3JpcHRpb24gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXB0aW9uLWRlc2NyaXB0aW9uLWlucHV0XCIpO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItZm9ybVwiKTtcclxuY29uc3QgYXZhdGFyRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJGb3JtLmVsZW1lbnRzW1wiYXZhdGFyXCJdO1xyXG5jb25zdCBhdmF0YXJTdWJtaXRCdG4gPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcblxyXG5jb25zdCBwcm9maWxlTmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZUlucHV0Jyk7XHJcblxyXG5jb25zdCBuZXdQb3N0SW1hZ2VMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuY29uc3QgbmV3UG9zdENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG5cclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWwgLm1vZGFsX19jYXB0aW9uXCIpOyAvLyBvciB3aGF0ZXZlciB0aGUgY29ycmVjdCBzZWxlY3RvciBpc1xyXG5cclxuY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWwgLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld0Nsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkX3RlbXBsYXRlXCIpXHJcbiAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XHJcblxyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5jb25zdCBsaWtlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlLWJ1dHRvblwiKTtcclxuXHJcbmxldCBjYXJkVG9EZWxldGUgPSBudWxsO1xyXG5sZXQgY2FyZFRvRGVsZXRlSWQgPSBudWxsO1xyXG5sZXQgc2VsZWN0ZWRDYXJkID0gbnVsbDtcclxubGV0IHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcclxuXHJcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcblxyXG5tb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XHJcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gZXZ0LnRhcmdldDtcclxuICAgIGNvbnN0IGlzTGlrZWQgPSBsaWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcclxuXHJcbiAgICBjaGFuZ2VMaWtlU3RhdHVzKGlkLCAhaXNMaWtlZClcclxuICAgICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgbGlrZSBzdGF0dXM6XCIsIGVycik7XHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgICAgICAgY2xvc2VNb2RhbChhY3RpdmVNb2RhbCk7XHJcbiAgICB9XHJcblxyXG59O1xyXG5cclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGFwaS5lZGl0QXZhdGFySW5mbyhhdmF0YXJJbnB1dC52YWx1ZSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhLmF2YXRhcik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXInKTsgLy8gQWRqdXN0IHNlbGVjdG9yIGFzIG5lZWRlZFxyXG4gICAgICAgICAgICBpZiAoYXZhdGFySW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIGF2YXRhckltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKGVkaXRBdmF0YXJNb2RhbCk7XHJcblxyXG4gICAgICAgICAgICBhdmF0YXJJbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB1cGRhdGUgYXZhdGFyOicsIGVycik7XHJcbiAgICAgICAgICAgIGFsZXJ0KCdDb3VsZCBub3QgdXBkYXRlIGF2YXRhci4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcclxuICAgICAgICB9KTtcclxufVxyXG5cclxuYXZhdGFyRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKGVkaXRBdmF0YXJNb2RhbCk7XHJcblxyXG4gICAgY29uc3QgZWRpdEF2YXRhckNsb3NlQnRuID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuICAgIGVkaXRBdmF0YXJDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGNsb3NlTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcclxuICAgIH0pO1xyXG59KVxyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGFwaVxyXG4gICAgICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGNhcmRJZCkge1xyXG4gICAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbn1cclxuXHJcbmNvbnN0IHNhdmVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZUJ0bicpO1xyXG5jb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVsZXRlQnRuJyk7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9maWxlLWZvcm0nKTsgLy8gb3Igd2hhdGV2ZXIgeW91ciBmb3JtIElEIGlzXHJcblxyXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdEZWxldGluZy4uLic7XHJcbiAgICBkZWxldGVCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgIGFwaS5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ2FyZCkgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhcmQ6JywgZXJyKTtcclxuICAgICAgICAgICAgYWxlcnQoJ0ZhaWxlZCB0byBkZWxldGUgY2FyZC4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgZGVsZXRlQnRuLnRleHRDb250ZW50ID0gJ0RlbGV0ZSc7XHJcbiAgICAgICAgICAgIGRlbGV0ZUJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcclxuICAgIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xyXG4gICAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcclxuICAgIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soZGF0YSkge1xyXG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3Q2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRfdGVtcGxhdGVcIik7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgY29uc3QgY2FyZFRpdGxlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XHJcbiAgICBjb25zdCBkZWxldGVCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XHJcblxyXG4gICAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gICAgaWYgKGRhdGEuaXNMaWtlZCkge1xyXG4gICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaXNMaWtlZCA9IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpO1xyXG5cclxuICAgICAgICBhcGkuYWRkTGlrZShkYXRhLl9pZCwgaXNMaWtlZClcclxuICAgICAgICAgICAgLnRoZW4odXBkYXRlZENhcmQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGVkIGNhcmQgcmVzcG9uc2U6XCIsIHVwZGF0ZWRDYXJkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIiwgdXBkYXRlZENhcmQuaXNMaWtlZCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihcIkxpa2UgdG9nZ2xlIGZhaWxlZDpcIiwgZXJyKSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGhhbmRsZUltYWdlQ2xpY2soZGF0YSkpO1xyXG5cclxuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG4gICAgICAgIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fZGVsZXRlLWJ0blwiKSkge1xyXG4gICAgICAgIG9wZW5EZWxldGVNb2RhbCgpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQ7XHJcbiAgICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudDtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZWRpdFByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgcmVzZXRWYWxpZGF0aW9uKGVkaXRQcm9maWxlRm9ybSwgaW5wdXRMaXN0LCBzZXR0aW5ncyk7XHJcbiAgICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pXHJcblxyXG5lZGl0UHJvZmlsZUNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblxyXG4gICAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcclxufSk7XHJcblxyXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSlcclxuXHJcbm5ld1Bvc3RDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcclxuICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlKTtcclxuXHJcbiAgICBjb25zdCBuYW1lID0gZWRpdFByb2ZpbGVOYW1lSW5wdXQudmFsdWUudHJpbSgpO1xyXG4gICAgY29uc3QgYWJvdXQgPSBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUudHJpbSgpO1xyXG5cclxuICAgIGlmICghbmFtZSB8fCAhYWJvdXQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiTmFtZSBhbmQgQWJvdXQgZmllbGRzIG11c3Qgbm90IGJlIGVtcHR5LlwiKTtcclxuICAgICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBhcGkuZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgICAgICBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSBwcm9maWxlOlwiLCBlcnIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5jb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuRGVsZXRlTW9kYWwoKSB7XHJcbiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVsZXRlLW1vZGFsXCIpO1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcclxufVxyXG5cclxuXHJcbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KTtcclxuXHJcbnByZXZpZXdDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59KTtcclxuXHJcbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBuZXdQb3N0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5cclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge1xyXG4gICAgICAgIG5hbWU6IG5ld1Bvc3RDYXB0aW9uRGVzY3JpcHRpb24udmFsdWUudHJpbSgpLFxyXG4gICAgICAgIGxpbms6IG5ld1Bvc3RDYXJkSW1hZ2VJbnB1dC52YWx1ZS50cmltKClcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFpbnB1dFZhbHVlcy5uYW1lIHx8ICFpbnB1dFZhbHVlcy5saW5rKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkJvdGggbmFtZSBhbmQgaW1hZ2UgbGluayBhcmUgcmVxdWlyZWQuXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgdHJ1ZSk7XHJcblxyXG4gICAgYXBpLmFkZENhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbiAgICAgICAgICAgIG5ld1Bvc3RGb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20obmV3UG9zdEZvcm0ucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGFkZCBjYXJkOlwiLCBlcnIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59KTtcclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gICAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ2FyZCBpdGVtOicsIGl0ZW0pO1xyXG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xyXG4gICAgICAgICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fZGVsZXRlLWJ0blwiKSkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRcIik7XHJcbiAgICAgICAgY29uc3QgY2FyZElkID0gY2FyZEVsZW1lbnQ/LmRhdGFzZXQuaWQ7XHJcblxyXG4gICAgICAgIGlmICghY2FyZElkKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYXJkIElEIG5vdCBmb3VuZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FyZFRvRGVsZXRlID0gY2FyZEVsZW1lbnQ7XHJcbiAgICAgICAgY2FyZFRvRGVsZXRlSWQgPSBjYXJkSWQ7XHJcblxyXG4gICAgICAgIG9wZW5EZWxldGVNb2RhbCgpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXInKTtcclxuICAgIGlmIChhdmF0YXJJbWFnZSkge1xyXG4gICAgICAgIGF2YXRhckltYWdlLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICAgIH1cclxufSk7XHJcblxyXG5cclxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTsiLCJjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgICBnZXRBcHBJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMsIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQsXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlZGl0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyLFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlQXZhdGFyKGxpbmspIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGxpbmsgfSksXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZExpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgICAgICBjb25zdCBtZXRob2QgPSBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCI7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICByZW1vdmVMaWtlKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7Il0sIm5hbWVzIjpbIm1hcCIsIndlYnBhY2tDb250ZXh0IiwicmVxIiwiaWQiLCJ3ZWJwYWNrQ29udGV4dFJlc29sdmUiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibyIsImUiLCJFcnJvciIsImNvZGUiLCJrZXlzIiwiT2JqZWN0IiwicmVzb2x2ZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicCIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsIiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImJ1dHRvbkVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwic2V0QnV0dG9uVGV4dCIsImJ1dHRvbiIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwibG9hZGluZ1RleHQiLCJyZXF1aXJlIiwiYXBpIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImVkaXRVc2VySW5mbyIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJ1cGRhdGVBdmF0YXIiLCJsaW5rIiwiYWRkQ2FyZCIsImRlbGV0ZUNhcmQiLCJhZGRMaWtlIiwiaXNMaWtlZCIsInJlbW92ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGVCdG4iLCJlZGl0UHJvZmlsZU1vZGFsIiwiZWRpdEF2YXRhck1vZGFsIiwiZWRpdFByb2ZpbGVDbG9zZUJ0biIsImVkaXRQcm9maWxlRm9ybSIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdEJ0biIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RDbG9zZUJ0biIsIm5ld1Bvc3RGb3JtIiwibmV3UG9zdENhcmRJbWFnZUlucHV0IiwibmV3UG9zdENhcHRpb25EZXNjcmlwdGlvbiIsImF2YXRhckZvcm0iLCJhdmF0YXJFZGl0QnRuIiwiYXZhdGFySW5wdXQiLCJlbGVtZW50cyIsInByb2ZpbGVOYW1lRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsInByZXZpZXdNb2RhbCIsImdldEVsZW1lbnRCeUlkIiwicHJldmlld0NhcHRpb24iLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3Q2xvc2VCdG4iLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJjYXJkc0xpc3QiLCJjb250ZW50IiwiY2FyZFRvRGVsZXRlIiwiY2FyZFRvRGVsZXRlSWQiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImhhbmRsZUVzY2FwZSIsImV2dCIsImtleSIsImNsb3NlTW9kYWwiLCJtb2RhbCIsInRhcmdldCIsImNvbnRhaW5zIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiYXZhdGFySW1hZ2UiLCJzcmMiLCJjYXRjaCIsImVyciIsImVycm9yIiwiYWxlcnQiLCJvcGVuTW9kYWwiLCJkZWxldGVCdG4iLCJnZXRDYXJkRWxlbWVudCIsImNhcmRFbGVtZW50IiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlRWwiLCJjYXJkSW1hZ2VFbCIsImxpa2VCdXR0b24iLCJkZWxldGVCdXR0b24iLCJhbHQiLCJfaWQiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9wZW5EZWxldGVNb2RhbCIsImZpbmFsbHkiLCJyZXNldFZhbGlkYXRpb24iLCJzdWJtaXRCdXR0b24iLCJzdWJtaXR0ZXIiLCJ0cmltIiwiaW5wdXRWYWx1ZXMiLCJwcmVwZW5kIiwicmVzZXQiLCJjYXJkcyIsIml0ZW0iLCJhcHBlbmQiLCJjbG9zZXN0IiwiY2FyZElkIiwiZGF0YXNldCIsInVzZXJEYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==