!function(){var e={31:function(e,t,r){"use strict";e.exports=r.p+"c5b17daa11333c2f0346.svg"},36:function(e,t,r){"use strict";e.exports=r.p+"d19faa0112f44e2b6e01.svg"},58:function(e,t,r){"use strict";e.exports=r.p+"ac218ab8ae2c025add31.jpg"},66:function(e,t,r){"use strict";e.exports=r.p+"44b92084d1c40cb0a70b.jpg"},117:function(e,t,r){"use strict";e.exports=r.p+"2fc47fd8e9a9bcd9612f.jpg"},238:function(e,t,r){"use strict";e.exports=r.p+"53f0bab7ec2e970778f9.svg"},303:function(e,t,r){"use strict";e.exports=r.p+"40608da7369d39bc1077.svg"},338:function(e,t,r){"use strict";e.exports=r.p+"f37cd48ce187723b17f6.jpg"},353:function(e,t,r){"use strict";e.exports=r.p+"6cc9a0b44bfd83f0954f.svg"},418:function(e,t,r){"use strict";e.exports=r.p+"29a25a3c4fb6b6e4a7d6.svg"},511:function(e,t,r){"use strict";e.exports=r.p+"a326e1ad56a2cd944a28.svg"},528:function(e,t,r){"use strict";e.exports=r.p+"a326e1ad56a2cd944a28.svg"},563:function(e,t,r){"use strict";e.exports=r.p+"b431bbb397d7a39486fd.jpg"},588:function(e,t,r){var o={"./1-photo-by-moritz-feldmann-from-pexels.jpg":751,"./2-photo-by-ceiline-from-pexels.jpg":926,"./3-photo-by-tubanur-dogan-from-pexels.jpg":563,"./4-photo-by-maurice-laschet-from-pexels.jpg":66,"./5-photo-by-van-anh-nguyen-from-pexels.jpg":58,"./6-photo-by-moritz-feldmann-from-pexels.jpg":338,"./Group2.svg":988,"./Logo.svg":848,"./Union.svg":418,"./avatar.jpg":117,"./closeicon.svg":528,"./closeicondefault.svg":511,"./closeiconhover.svg":878,"./closemodalbtn.svg":238,"./closemodalhoverstate.svg":31,"./deletebtn.svg":36,"./deletebtnHover.svg":842,"./editAvatarimg.svg":683,"./likebtncolorchg.svg":783,"./likebtnhoverstate.svg":353,"./plusiconuse.svg":303};function n(e){var t=s(e);return r(t)}function s(e){if(!r.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=s,e.exports=n,n.id=588},683:function(e,t,r){"use strict";e.exports=r.p+"1e97cb162582fe640c54.svg"},751:function(e,t,r){"use strict";e.exports=r.p+"418980fdb81d7ceb84cc.jpg"},783:function(e,t,r){"use strict";e.exports=r.p+"0f0dda9918e145f68d20.svg"},842:function(e,t,r){"use strict";e.exports=r.p+"86ae92bd1a937388d496.svg"},848:function(e,t,r){"use strict";e.exports=r.p+"8650253b58b46f0f1c06.svg"},878:function(e,t,r){"use strict";e.exports=r.p+"a8e301eb86866b1df117.svg"},926:function(e,t,r){"use strict";e.exports=r.p+"da7ae2ac910426f62176.jpg"},988:function(e,t,r){"use strict";e.exports=r.p+"1ecf96fab54a91c898b4.svg"}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=e=>{document.querySelectorAll(e.formSelector).forEach(r=>{((e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),s=e.querySelector(r.submitButtonSelector);n.forEach(a=>{a.addEventListener("input",function(){((e,r,o)=>{r.validity.valid?t(e,r,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,r,r.validationMessage,o)})(e,a,r),o(n,s,r)})})})(r,e)})};function s(e,t,r="Save",o="Saving..."){e&&(e.textContent=t?o:r)}n(e);r(588);const a=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitialCards,this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}addCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}addLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"1e20e2ef-1387-4112-bcbf-1a5b3929946c","Content-Type":"application/json"}}),c=document.querySelector(".profile__edit-btn"),i=document.querySelector("#edit-profile-modal"),d=i.querySelector(".modal__close-btn"),l=i.querySelector(".modal__form"),u=i.querySelector("#profile-name-input"),m=i.querySelector("#profile-description-input"),f=document.querySelector(".profile__add-btn"),p=document.querySelector("#new-post-modal"),v=p.querySelector(".modal__close-btn"),b=p.querySelector(".modal__form"),_=p.querySelector("#card-image-input"),h=p.querySelector("#caption-description-input"),y=document.querySelector("#edit-avatar-form"),g=(y.elements.avatar,y.querySelector(".modal__submit-btn"),document.querySelector(".profile__name")),S=document.querySelector(".profile__description"),q=(document.getElementById("nameInput"),document.querySelector(".card__image"),document.querySelector(".card__title"),document.querySelector("#avatar-modal")),E=document.querySelector("#avatar-modal .modal__caption"),k=document.querySelector("#avatar-modal .modal__image"),x=document.querySelector(".modal__close-btn"),L=document.querySelector("#delete-modal"),j=L.querySelector(".modal__form"),C=(document.querySelector("#card_template").content.querySelector(".card"),document.querySelector(".cards__list"));document.querySelector(".like-button");let $=null,U=null,A=null,P=null;function I(e){"Escape"===e.key&&T(document.querySelector(".modal_is-opened"))}document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("click",t=>{t.target.classList.contains("modal")&&T(e)})}),document.getElementById("saveBtn");const B=document.getElementById("deleteBtn");function D(e){const t=document.querySelector("#card_template").content.querySelector(".card").cloneNode(!0);t.setAttribute("data-id",e._id);const r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=(t.querySelector(".card__like-button"),t.querySelector(".card__delete-btn"));o.src=e.link,o.alt=e.name,r.textContent=e.name,o.addEventListener("click",()=>function(e){k.src=e.link,k.alt=e.name,E.textContent=e.name,O(q)}(e)),document.querySelector(".cards__list");const s=t.querySelector(".card__like-btn");s.addEventListener("click",()=>{s.classList.toggle("card__like-btn_active")}),n.addEventListener("click",r=>{!function(e,t){A=e,P=t._id,O(L)}(t,e),$=t,U=e._id,O(L)});const a=document.querySelector("#delete-modal .modal__submit-btn[type='submit']"),c=document.querySelector("#delete-modal .modal__submit-btn[type='button']");return a.addEventListener("click",()=>{$&&($.remove(),$=null,T(document.querySelector("#delete-modal")))}),c.addEventListener("click",()=>{$=null,T(document.querySelector("#delete-modal"))}),t}function O(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",I)}function T(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",I)}function N(){document.getElementById("delete-modal").classList.add("modal_is-opened")}document.getElementById("profile-form"),j.addEventListener("submit",e=>{e.preventDefault(),B.textContent="Deleting...",B.disabled=!0,a.deleteCard(P).then(()=>{A&&A.remove(),T(L)}).catch(e=>{console.error("Error deleting card:",e),alert("Failed to delete card. Please try again.")}).finally(()=>{B.textContent="Delete",B.disabled=!1})}),document.addEventListener("click",function(e){e.target.classList.contains("card__delete-btn")&&N()}),c.addEventListener("click",()=>{u.value=g.textContent,m.value=S.textContent;const r=Array.from(l.querySelectorAll(e.inputSelector));((e,r,o)=>{r.forEach(r=>{t(e,r,o)})})(l,r,e),O(i)}),d.addEventListener("click",()=>{T(i)}),f.addEventListener("click",function(){O(p)}),v.addEventListener("click",()=>{T(p)}),document.querySelector(".cards__list"),l.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;s(t,!0);const r=u.value.trim(),o=m.value.trim();if(!r||!o)return console.error("Name and About fields must not be empty."),void s(t,!1);a.editUserInfo({name:r,about:o}).then(e=>{g.textContent=e.name,S.textContent=e.about,T(i)}).catch(e=>{console.error("Failed to update profile:",e)}).finally(()=>{s(t,!1)})}),x.addEventListener("click",function(){T(q)}),b.addEventListener("submit",function(t){t.preventDefault();const r=b.querySelector(".modal__submit-btn"),n={name:h.value.trim(),link:_.value.trim()};n.name&&n.link?(s(r,!0),a.addCard(n).then(t=>{const n=D(t);C.prepend(n),T(p),b.reset();const s=Array.from(b.querySelectorAll(e.inputSelector));o(s,r,e)}).catch(e=>{console.error("Failed to add card:",e)}).finally(()=>{s(r,!1)})):console.error("Both name and image link are required.")}),a.getInitialCards().then(e=>{e.forEach(e=>{console.log("Card item:",e);const t=D(e);C.append(t)})}).catch(console.error),document.addEventListener("click",e=>{if(e.target.classList.contains("card__delete-btn")){const t=e.target.closest(".card"),r=t?.dataset.id;if(!r)return void console.error("Card ID not found");$=t,U=r,N()}}),j.addEventListener("submit",function(e){e.preventDefault(),a.deleteCard(P).then(()=>{A.remove(),T(L)}).catch(console.error)}),n(e)}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJBQWlCLFNBNVA1QixTQUE0QjZFLEdBQ3hCQSxFQUFJMkIsaUJBRUo3RixFQUNLK0IsV0FBV2lDLEdBQ1huRCxLQUFLLEtBQ0ZrRCxFQUFhOUYsU0FDYm1HLEVBQVdYLEtBRWRxQyxNQUFNRSxRQUFRQyxNQUN2QixHQW9QQXJILEVBQWlCekIsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvaW1hZ2VzLyBzeW5jIG5vbnJlY3Vyc2l2ZSBcXC4oc3ZnJTdDanBlIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIG1hcCA9IHtcblx0XCIuLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiOiA3NTEsXG5cdFwiLi8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCI6IDkyNixcblx0XCIuLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIjogNTYzLFxuXHRcIi4vNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCI6IDY2LFxuXHRcIi4vNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIjogNTgsXG5cdFwiLi82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIjogMzM4LFxuXHRcIi4vR3JvdXAyLnN2Z1wiOiA5ODgsXG5cdFwiLi9Mb2dvLnN2Z1wiOiA4NDgsXG5cdFwiLi9Vbmlvbi5zdmdcIjogNDE4LFxuXHRcIi4vYXZhdGFyLmpwZ1wiOiAxMTcsXG5cdFwiLi9jbG9zZWljb24uc3ZnXCI6IDUyOCxcblx0XCIuL2Nsb3NlaWNvbmRlZmF1bHQuc3ZnXCI6IDUxMSxcblx0XCIuL2Nsb3NlaWNvbmhvdmVyLnN2Z1wiOiA4NzgsXG5cdFwiLi9jbG9zZW1vZGFsYnRuLnN2Z1wiOiAyMzgsXG5cdFwiLi9jbG9zZW1vZGFsaG92ZXJzdGF0ZS5zdmdcIjogMzEsXG5cdFwiLi9kZWxldGVidG4uc3ZnXCI6IDM2LFxuXHRcIi4vZGVsZXRlYnRuSG92ZXIuc3ZnXCI6IDg0Mixcblx0XCIuL2VkaXRBdmF0YXJpbWcuc3ZnXCI6IDY4Myxcblx0XCIuL2xpa2VidG5jb2xvcmNoZy5zdmdcIjogNzgzLFxuXHRcIi4vbGlrZWJ0bmhvdmVyc3RhdGUuc3ZnXCI6IDM1Myxcblx0XCIuL3BsdXNpY29udXNlLnN2Z1wiOiAzMDNcbn07XG5cblxuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHZhciBpZCA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpO1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhpZCk7XG59XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8obWFwLCByZXEpKSB7XG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBtYXBbcmVxXTtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSA1ODg7IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuXHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICAgIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwpID0+IHtcclxuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpOyIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KGJ1dHRvbiwgaXNMb2FkaW5nLCBkZWZhdWx0VGV4dCA9IFwiU2F2ZVwiLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBpZiAoIWJ1dHRvbikgcmV0dXJuO1xyXG4gIGJ1dHRvbi50ZXh0Q29udGVudCA9IGlzTG9hZGluZyA/IGxvYWRpbmdUZXh0IDogZGVmYXVsdFRleHQ7XHJcbn1cclxuXHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzLCByZXNldFZhbGlkYXRpb24sIHRvZ2dsZUJ1dHRvblN0YXRlLCBlbmFibGVWYWxpZGF0aW9uIH0gZnJvbSAnLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzJztcclxuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gJy4uL3V0aWxzL2hlbHBlcnMuanMnO1xyXG5pbXBvcnQgQXBpIGZyb20gJy4uL3V0aWxzL0FwaS5qcyc7XHJcblxyXG5jb25zdCBpbWFnZXMgPSByZXF1aXJlLmNvbnRleHQoJy4uL2ltYWdlcycsIGZhbHNlLCAvXFwuKHN2Z3xqcGU/ZykkLyk7XHJcblxyXG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAgICB7XHJcbi8vICAgICAgICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyAgICAge1xyXG4vLyAgICAgICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyAgICAge1xyXG4vLyAgICAgICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXHJcbi8vICAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICAgIH0sXHJcbi8vICAgICB7XHJcbi8vICAgICAgICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgICAgfSxcclxuLy8gICAgIHtcclxuLy8gICAgICAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4vLyAgICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICAgIH0sXHJcbi8vICAgICB7XHJcbi8vICAgICAgICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbi8vICAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyAgICAge1xyXG4vLyAgICAgICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcclxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgICB9LFxyXG4vLyBdO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCIxZTIwZTJlZi0xMzg3LTQxMTItYmNiZi0xYTViMzkyOTk0NmNcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnRuID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XHJcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RGb3JtID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IG5ld1Bvc3RDYXJkSW1hZ2VJbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2UtaW5wdXRcIik7XHJcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uRGVzY3JpcHRpb24gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXB0aW9uLWRlc2NyaXB0aW9uLWlucHV0XCIpO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItZm9ybVwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJGb3JtLmVsZW1lbnRzW1wiYXZhdGFyXCJdO1xyXG5jb25zdCBhdmF0YXJTdWJtaXRCdG4gPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcblxyXG5jb25zdCBwcm9maWxlTmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZUlucHV0Jyk7XHJcblxyXG5jb25zdCBuZXdQb3N0SW1hZ2VMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuY29uc3QgbmV3UG9zdENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG5cclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWwgLm1vZGFsX19jYXB0aW9uXCIpOyAvLyBvciB3aGF0ZXZlciB0aGUgY29ycmVjdCBzZWxlY3RvciBpc1xyXG5cclxuY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWwgLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld0Nsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkX3RlbXBsYXRlXCIpXHJcbiAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XHJcblxyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5jb25zdCBsaWtlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlLWJ1dHRvblwiKTtcclxuXHJcbmxldCBjYXJkVG9EZWxldGUgPSBudWxsO1xyXG5sZXQgY2FyZFRvRGVsZXRlSWQgPSBudWxsO1xyXG5sZXQgc2VsZWN0ZWRDYXJkID0gbnVsbDtcclxubGV0IHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcclxuXHJcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcblxyXG5tb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XHJcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gZXZ0LnRhcmdldDtcclxuICAgIGNvbnN0IGlzTGlrZWQgPSBsaWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcclxuXHJcbiAgICBjaGFuZ2VMaWtlU3RhdHVzKGlkLCAhaXNMaWtlZClcclxuICAgICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgbGlrZSBzdGF0dXM6XCIsIGVycik7XHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgICAgICAgY2xvc2VNb2RhbChhY3RpdmVNb2RhbCk7XHJcbiAgICB9XHJcblxyXG59O1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xyXG4gICAgYXBpXHJcbiAgICAgICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEuYXZhdGFyKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2soY2FyZElkKSB7XHJcbiAgICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcclxufVxyXG5cclxuY29uc3Qgc2F2ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlQnRuJyk7XHJcbmNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxldGVCdG4nKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2ZpbGUtZm9ybScpOyAvLyBvciB3aGF0ZXZlciB5b3VyIGZvcm0gSUQgaXNcclxuXHJcbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgZGVsZXRlQnRuLnRleHRDb250ZW50ID0gJ0RlbGV0aW5nLi4uJztcclxuICAgIGRlbGV0ZUJ0bi5kaXNhYmxlZCA9IHRydWU7XHJcblxyXG4gICAgYXBpLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDYXJkKSBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FyZDonLCBlcnIpO1xyXG4gICAgICAgICAgICBhbGVydCgnRmFpbGVkIHRvIGRlbGV0ZSBjYXJkLiBQbGVhc2UgdHJ5IGFnYWluLicpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSAnRGVsZXRlJztcclxuICAgICAgICAgICAgZGVsZXRlQnRuLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xyXG4gICAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgICBzZWxlY3RlZENhcmRJZCA9IGRhdGEuX2lkO1xyXG4gICAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSB7XHJcbiAgICBwcmV2aWV3SW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgcHJldmlld0ltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuXHJcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRfdGVtcGxhdGVcIik7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgY2FyZEVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBkYXRhLl9pZCk7XHJcblxyXG5cclxuICAgIGNvbnN0IGNhcmRUaXRsZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNvbnN0IGxpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgZGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG5cclxuXHJcbiAgICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBjYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuXHJcbiAgICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSk7XHJcblxyXG4gICAgY29uc3QgY2FyZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuICAgIGNvbnN0IGNhcmRMaWtlQnRuRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG4gICAgY2FyZExpa2VCdG5FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGNhcmRMaWtlQnRuRWwuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG5cclxuICAgICAgICBjYXJkVG9EZWxldGUgPSBjYXJkRWxlbWVudDtcclxuICAgICAgICBjYXJkVG9EZWxldGVJZCA9IGRhdGEuX2lkO1xyXG5cclxuICAgICAgICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgY29uZmlybURlbGV0ZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsIC5tb2RhbF9fc3VibWl0LWJ0blt0eXBlPSdzdWJtaXQnXVwiKTtcclxuICAgIGNvbnN0IGNhbmNlbERlbGV0ZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsIC5tb2RhbF9fc3VibWl0LWJ0blt0eXBlPSdidXR0b24nXVwiKTtcclxuXHJcbiAgICBjb25maXJtRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGNhcmRUb0RlbGV0ZSkge1xyXG4gICAgICAgICAgICBjYXJkVG9EZWxldGUucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGNhcmRUb0RlbGV0ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIikpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNhbmNlbERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGNhcmRUb0RlbGV0ZSA9IG51bGw7XHJcbiAgICAgICAgY2xvc2VNb2RhbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fZGVsZXRlLWJ0blwiKSkge1xyXG4gICAgICAgIG9wZW5EZWxldGVNb2RhbCgpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQ7XHJcbiAgICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudDtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZWRpdFByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgcmVzZXRWYWxpZGF0aW9uKGVkaXRQcm9maWxlRm9ybSwgaW5wdXRMaXN0LCBzZXR0aW5ncyk7XHJcbiAgICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pXHJcblxyXG5lZGl0UHJvZmlsZUNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblxyXG4gICAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcclxufSk7XHJcblxyXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSlcclxuXHJcbm5ld1Bvc3RDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcclxuICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlKTtcclxuXHJcbiAgICBjb25zdCBuYW1lID0gZWRpdFByb2ZpbGVOYW1lSW5wdXQudmFsdWUudHJpbSgpO1xyXG4gICAgY29uc3QgYWJvdXQgPSBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUudHJpbSgpO1xyXG5cclxuICAgIGlmICghbmFtZSB8fCAhYWJvdXQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiTmFtZSBhbmQgQWJvdXQgZmllbGRzIG11c3Qgbm90IGJlIGVtcHR5LlwiKTtcclxuICAgICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBhcGkuZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgICAgICBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSBwcm9maWxlOlwiLCBlcnIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5jb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuRGVsZXRlTW9kYWwoKSB7XHJcbiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVsZXRlLW1vZGFsXCIpO1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcclxufVxyXG5cclxuXHJcbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KTtcclxuXHJcbnByZXZpZXdDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59KTtcclxuXHJcbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBuZXdQb3N0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5cclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge1xyXG4gICAgICAgIG5hbWU6IG5ld1Bvc3RDYXB0aW9uRGVzY3JpcHRpb24udmFsdWUudHJpbSgpLFxyXG4gICAgICAgIGxpbms6IG5ld1Bvc3RDYXJkSW1hZ2VJbnB1dC52YWx1ZS50cmltKClcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFpbnB1dFZhbHVlcy5uYW1lIHx8ICFpbnB1dFZhbHVlcy5saW5rKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkJvdGggbmFtZSBhbmQgaW1hZ2UgbGluayBhcmUgcmVxdWlyZWQuXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgdHJ1ZSk7XHJcblxyXG4gICAgYXBpLmFkZENhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbiAgICAgICAgICAgIG5ld1Bvc3RGb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20obmV3UG9zdEZvcm0ucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGFkZCBjYXJkOlwiLCBlcnIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59KTtcclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gICAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ2FyZCBpdGVtOicsIGl0ZW0pO1xyXG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xyXG4gICAgICAgICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fZGVsZXRlLWJ0blwiKSkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRcIik7XHJcbiAgICAgICAgY29uc3QgY2FyZElkID0gY2FyZEVsZW1lbnQ/LmRhdGFzZXQuaWQ7XHJcblxyXG4gICAgICAgIGlmICghY2FyZElkKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYXJkIElEIG5vdCBmb3VuZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FyZFRvRGVsZXRlID0gY2FyZEVsZW1lbnQ7XHJcbiAgICAgICAgY2FyZFRvRGVsZXRlSWQgPSBjYXJkSWQ7XHJcblxyXG4gICAgICAgIG9wZW5EZWxldGVNb2RhbCgpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7IiwiY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0QXBwSW5mbygpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0LFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZWRpdEF2YXRhckluZm8oYXZhdGFyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIGF2YXRhcixcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUF2YXRhcihsaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBsaW5rIH0pLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRMaWtlKGlkLCBpc0xpa2VkKSB7XHJcbiAgICAgICAgY29uc3QgbWV0aG9kID0gaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiO1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVMaWtlKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7Il0sIm5hbWVzIjpbIm1hcCIsIndlYnBhY2tDb250ZXh0IiwicmVxIiwiaWQiLCJ3ZWJwYWNrQ29udGV4dFJlc29sdmUiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibyIsImUiLCJFcnJvciIsImNvZGUiLCJrZXlzIiwiT2JqZWN0IiwicmVzb2x2ZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicCIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsIiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImJ1dHRvbkVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwic2V0QnV0dG9uVGV4dCIsImJ1dHRvbiIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwibG9hZGluZ1RleHQiLCJyZXF1aXJlIiwiYXBpIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImVkaXRVc2VySW5mbyIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJ1cGRhdGVBdmF0YXIiLCJsaW5rIiwiYWRkQ2FyZCIsImRlbGV0ZUNhcmQiLCJhZGRMaWtlIiwiaXNMaWtlZCIsInJlbW92ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGVCdG4iLCJlZGl0UHJvZmlsZU1vZGFsIiwiZWRpdFByb2ZpbGVDbG9zZUJ0biIsImVkaXRQcm9maWxlRm9ybSIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdEJ0biIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RDbG9zZUJ0biIsIm5ld1Bvc3RGb3JtIiwibmV3UG9zdENhcmRJbWFnZUlucHV0IiwibmV3UG9zdENhcHRpb25EZXNjcmlwdGlvbiIsImF2YXRhckZvcm0iLCJwcm9maWxlTmFtZUVsIiwiZWxlbWVudHMiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsInByZXZpZXdNb2RhbCIsImdldEVsZW1lbnRCeUlkIiwicHJldmlld0NhcHRpb24iLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3Q2xvc2VCdG4iLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJjYXJkc0xpc3QiLCJjb250ZW50IiwiY2FyZFRvRGVsZXRlIiwiY2FyZFRvRGVsZXRlSWQiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImhhbmRsZUVzY2FwZSIsImV2dCIsImtleSIsImNsb3NlTW9kYWwiLCJtb2RhbCIsInRhcmdldCIsImNvbnRhaW5zIiwiZGVsZXRlQnRuIiwiZ2V0Q2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJzZXRBdHRyaWJ1dGUiLCJfaWQiLCJjYXJkVGl0bGVFbCIsImNhcmRJbWFnZUVsIiwiZGVsZXRlQnV0dG9uIiwic3JjIiwiYWx0Iiwib3Blbk1vZGFsIiwiaGFuZGxlSW1hZ2VDbGljayIsImNhcmRMaWtlQnRuRWwiLCJ0b2dnbGUiLCJoYW5kbGVEZWxldGVDYXJkIiwiY29uZmlybURlbGV0ZUJ0biIsImNhbmNlbERlbGV0ZUJ0biIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvcGVuRGVsZXRlTW9kYWwiLCJwcmV2ZW50RGVmYXVsdCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYWxlcnQiLCJmaW5hbGx5IiwidmFsdWUiLCJyZXNldFZhbGlkYXRpb24iLCJzdWJtaXRCdXR0b24iLCJzdWJtaXR0ZXIiLCJ0cmltIiwiaW5wdXRWYWx1ZXMiLCJwcmVwZW5kIiwicmVzZXQiLCJjYXJkcyIsIml0ZW0iLCJsb2ciLCJhcHBlbmQiLCJjbG9zZXN0IiwiY2FyZElkIiwiZGF0YXNldCJdLCJzb3VyY2VSb290IjoiIn0=